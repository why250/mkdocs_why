---
date:
  created: 2025-11-06
draft: 
categories:
  - FPGA
tags:
  - SPI
authors:
  - why

---
I2C å’Œ SPI æ˜¯åµŒå…¥å¼ç³»ç»Ÿä¸­æœ€å¸¸ç”¨çš„ä¸¤ç§**åŒæ­¥ä¸²è¡Œé€šä¿¡åè®®**ï¼Œå®ƒä»¬éƒ½ç”¨äºŽåœ¨å•ä¸ªä¸»æ¿ä¸Šçš„èŠ¯ç‰‡ä¹‹é—´è¿›è¡ŒçŸ­è·ç¦»é€šä¿¡ï¼Œæ¯”å¦‚å•ç‰‡æœºï¼ˆMCUï¼‰ä¸Žä¼ æ„Ÿå™¨ã€å­˜å‚¨å™¨ã€ADC/DACç­‰å¤–è®¾ä¹‹é—´ã€‚

å°½ç®¡å®ƒä»¬çš„ç›®çš„ç›¸ä¼¼ï¼Œä½†å®žçŽ°æ–¹å¼ã€é€Ÿåº¦å’Œåº”ç”¨åœºæ™¯å´æœ‰å¾ˆå¤§ä¸åŒã€‚

---

### **SPI (Serial Peripheral Interface / ä¸²è¡Œå¤–è®¾æŽ¥å£)**

å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€æ¡**é«˜é€Ÿã€å…¨åŒå·¥çš„â€œç§å¯†ç”µè¯çº¿â€**ã€‚

#### **1. æ ¸å¿ƒæ¦‚å¿µ**

SPI æ˜¯ä¸€ç§**ä¸»ä»Žï¼ˆMaster-Slaveï¼‰**æž¶æž„çš„é€šä¿¡åè®®ã€‚é€šä¿¡æ€»æ˜¯ç”±ä¸»è®¾å¤‡ï¼ˆé€šå¸¸æ˜¯MCUï¼‰å‘èµ·ã€‚å®ƒé€Ÿåº¦éžå¸¸å¿«ï¼Œå¹¶ä¸”æ”¯æŒ**å…¨åŒå·¥**é€šä¿¡ï¼Œæ„å‘³ç€ä¸»è®¾å¤‡å’Œä»Žè®¾å¤‡å¯ä»¥åŒæ—¶å‘é€å’ŒæŽ¥æ”¶æ•°æ®ã€‚

#### **2. å·¥ä½œåŽŸç†ä¸Žå¼•è„š**

SPI é€šä¿¡é€šå¸¸éœ€è¦ **4 æ ¹çº¿**ï¼š

*   **SCLK (Serial Clock):** ä¸²è¡Œæ—¶é’Ÿã€‚ç”± Master äº§ç”Ÿï¼Œç”¨æ¥åŒæ­¥æ•°æ®ä¼ è¾“ï¼Œæ˜¯æ•´ä¸ªé€šä¿¡çš„â€œå¿ƒè·³â€ã€‚
*   **MOSI (Master Out Slave In):** ä¸»å‡ºä»Žå…¥ã€‚Master é€šè¿‡è¿™æ¡çº¿å‘ Slave å‘é€æ•°æ®ã€‚
*   **MISO (Master In Slave Out):** ä¸»å…¥ä»Žå‡ºã€‚Slave é€šè¿‡è¿™æ¡çº¿å‘ Master å‘é€æ•°æ®ã€‚
*   **CS / SS (Chip Select / Slave Select):** ç‰‡é€‰ä¿¡å·ã€‚ç”± Master æŽ§åˆ¶ã€‚å½“ Master æƒ³å’ŒæŸä¸ª Slave é€šä¿¡æ—¶ï¼Œä¼šå…ˆå°†å¯¹åº” Slave çš„ CS çº¿æ‹‰ä½Žï¼ˆå˜ä¸ºæœ‰æ•ˆç”µå¹³ï¼‰ã€‚åªæœ‰è¢«é€‰ä¸­çš„ Slave æ‰ä¼šå“åº” SCLK å’Œ MOSI ä¸Šçš„ä¿¡å·ã€‚

**é€šä¿¡æµç¨‹ï¼š**
1.  Master å°†æƒ³è¦é€šä¿¡çš„é‚£ä¸ª Slave çš„ **CS** çº¿æ‹‰ä½Žã€‚
2.  Master åœ¨ **SCLK** çº¿ä¸Šäº§ç”Ÿæ—¶é’Ÿè„‰å†²ã€‚
3.  åœ¨æ¯ä¸ªæ—¶é’Ÿè„‰å†²ï¼ŒMaster å°†ä¸€ä½æ•°æ®æŽ¨é€åˆ° **MOSI** çº¿ä¸Šï¼ŒåŒæ—¶ä»Ž **MISO** çº¿ä¸Šè¯»å–ä¸€ä½æ•°æ®ã€‚
4.  é€šä¿¡ç»“æŸåŽï¼ŒMaster å°† **CS** çº¿æ‹‰é«˜ï¼Œç»“æŸæœ¬æ¬¡é€šä¿¡ã€‚



#### **3. ä¼˜ç¼ºç‚¹**

| ä¼˜ç‚¹ ðŸ‘                                         | ç¼ºç‚¹ ðŸ‘Ž                                                 |
| ----------------------------------------------- | ------------------------------------------------------- |
| **é€Ÿåº¦éžå¸¸å¿«**ï¼Œé€šå¸¸å¯è¾¾å‡ å Mbpsã€‚             | **éœ€è¦æ›´å¤šå¼•è„š**ï¼Œæ¯ä¸ªä»Žè®¾å¤‡éƒ½éœ€è¦ä¸€æ ¹ç‹¬ç«‹çš„ CS çº¿ã€‚      |
| **å…¨åŒå·¥é€šä¿¡**ï¼Œæ•°æ®å¯ä»¥åŒæ—¶æ”¶å‘ï¼Œæ•ˆçŽ‡é«˜ã€‚      | **æ²¡æœ‰å†…ç½®çš„å¯»å€æœºåˆ¶**ï¼Œå®Œå…¨ä¾èµ– CS çº¿æ¥é€‰æ‹©ä»Žè®¾å¤‡ã€‚    |
| **åè®®ç®€å•**ï¼Œç¡¬ä»¶å®žçŽ°å®¹æ˜“ï¼Œè½¯ä»¶å¼€é”€å°ã€‚        | **æ²¡æœ‰ä»Žè®¾å¤‡åº”ç­”ï¼ˆACKï¼‰æœºåˆ¶**ï¼ŒMaster ä¸çŸ¥é“æ•°æ®æ˜¯å¦è¢«æˆåŠŸæŽ¥æ”¶ã€‚ |
| çµæ´»æ€§é«˜ï¼Œæ•°æ®ä½æ•°å’Œä¼ è¾“æ ¼å¼å¯ä»¥è‡ªå®šä¹‰ã€‚        | **æ²¡æœ‰æ ‡å‡†åŒ–çš„å¤šä¸»æŽ§æ”¯æŒ**ï¼Œé€šå¸¸åªæœ‰ä¸€ä¸ª Masterã€‚         |

---

### **I2C (Inter-Integrated Circuit / é›†æˆç”µè·¯æ€»çº¿)**

å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ª**â€œç”µè¯ä¼šè®®â€æˆ–â€œæ´¾å¯¹çƒ­çº¿â€**ï¼Œæ‰€æœ‰è®¾å¤‡éƒ½åœ¨åŒä¸€æ¡çº¿ä¸Šï¼Œé€šè¿‡â€œå–Šåå­—â€æ¥äº¤æµã€‚

#### **1. æ ¸å¿ƒæ¦‚å¿µ**

I2C æ˜¯ä¸€ç§**å¤šä¸»æŽ§ã€å¤šä»Žè®¾å¤‡**çš„æ€»çº¿åž‹åè®®ã€‚å®ƒåªéœ€è¦ä¸¤æ ¹çº¿å°±å¯ä»¥è¿žæŽ¥å¤§é‡çš„è®¾å¤‡ã€‚é€šä¿¡æ˜¯**åŠåŒå·¥**çš„ï¼Œå³åœ¨åŒä¸€æ—¶åˆ»ï¼Œæ•°æ®åªèƒ½å•å‘ä¼ è¾“ã€‚

#### **2. å·¥ä½œåŽŸç†ä¸Žå¼•è„š**

I2C é€šä¿¡åªéœ€è¦ **2 æ ¹çº¿**ï¼š

*   **SDA (Serial Data):** ä¸²è¡Œæ•°æ®çº¿ã€‚ç”¨äºŽåŒå‘ä¼ è¾“æ•°æ®ã€‚
*   **SCL (Serial Clock):** ä¸²è¡Œæ—¶é’Ÿçº¿ã€‚é€šå¸¸ç”± Master äº§ç”Ÿï¼ŒåŒæ­¥æ•°æ®ä¼ è¾“ã€‚

**å…³é”®ç‰¹æ€§ï¼š**
*   **å¯»å€æœºåˆ¶ï¼š** æ¯ä¸ªè¿žæŽ¥åˆ°æ€»çº¿ä¸Šçš„ä»Žè®¾å¤‡éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„7ä½ï¼ˆæˆ–10ä½ï¼‰åœ°å€ã€‚Master å‘èµ·é€šä¿¡æ—¶ï¼Œé¦–å…ˆä¼šå‘é€ä¸€ä¸ªâ€œ**èµ·å§‹ä¿¡å·**â€ï¼Œç„¶åŽå¹¿æ’­å®ƒæƒ³æ‰¾çš„é‚£ä¸ªä»Žè®¾å¤‡çš„åœ°å€ã€‚
*   **åº”ç­”æœºåˆ¶ (ACK/NACK):** åœ°å€åŒ¹é…çš„ä»Žè®¾å¤‡åœ¨æŽ¥æ”¶åˆ°è‡ªå·±çš„åœ°å€åŽï¼Œä¼šå‘é€ä¸€ä¸ªâ€œ**åº”ç­”ä½ (ACK)**â€ç»™ Masterï¼Œå‘Šè¯‰å®ƒâ€œæˆ‘åœ¨çº¿ï¼Œå‡†å¤‡å¥½äº†â€ã€‚å¦‚æžœ Master å‘é€åœ°å€åŽæ²¡æœ‰æ”¶åˆ° ACKï¼Œå°±çŸ¥é“è¯¥è®¾å¤‡ä¸å­˜åœ¨æˆ–æ— å“åº”ã€‚
*   **ä¸Šæ‹‰ç”µé˜»ï¼š** SDA å’Œ SCL ä¸¤æ¡çº¿è·¯ä¸Šå¿…é¡»æŽ¥**ä¸Šæ‹‰ç”µé˜»**ã€‚è¿™æ˜¯å› ä¸º I2C è®¾å¤‡é‡‡ç”¨â€œå¼€æ¼â€æˆ–â€œå¼€é›†â€è¾“å‡ºï¼Œå®ƒä»¬åªèƒ½å°†æ€»çº¿æ‹‰ä½Žåˆ°0ï¼Œä¸èƒ½ä¸»åŠ¨è¾“å‡ºé«˜ç”µå¹³ã€‚å½“æ‰€æœ‰è®¾å¤‡éƒ½ä¸æ“ä½œæ—¶ï¼Œä¸Šæ‹‰ç”µé˜»ä¼šå°†æ€»çº¿æ‹‰åˆ°é«˜ç”µå¹³ã€‚

**é€šä¿¡æµç¨‹ï¼š**
1.  Master å‘é€ä¸€ä¸ª **èµ·å§‹ä¿¡å· (Start Condition)**ã€‚
2.  Master åœ¨ SDA çº¿ä¸Šå‘é€ **7ä½ä»Žè®¾å¤‡åœ°å€** å’Œ **1ä½è¯»/å†™æŽ§åˆ¶ä½**ã€‚
3.  æ€»çº¿ä¸Šæ‰€æœ‰ Slave ç›‘å¬åœ°å€ï¼ŒåŒ¹é…çš„ Slave å›žå¤ä¸€ä¸ª **ACK**ã€‚
4.  Masterï¼ˆæˆ– Slaveï¼Œå–å†³äºŽè¯»å†™æ“ä½œï¼‰å¼€å§‹ä¼ è¾“8ä½æ•°æ®ã€‚
5.  æ¯ä¼ è¾“å®Œä¸€ä¸ªå­—èŠ‚ï¼ŒæŽ¥æ”¶æ–¹éƒ½ä¼šå›žå¤ä¸€ä¸ª **ACK**ã€‚
6.  é€šä¿¡ç»“æŸåŽï¼ŒMaster å‘é€ä¸€ä¸ª **åœæ­¢ä¿¡å· (Stop Condition)**ï¼Œé‡Šæ”¾æ€»çº¿ã€‚



#### **3. ä¼˜ç¼ºç‚¹**

| ä¼˜ç‚¹ ðŸ‘                                               | ç¼ºç‚¹ ðŸ‘Ž                                             |
| --------------------------------------------------- | --------------------------------------------------- |
| **æžå°‘çš„å¼•è„š**ï¼Œä»…éœ€ 2 æ ¹çº¿å³å¯è¿žæŽ¥ä¼—å¤šè®¾å¤‡ã€‚         | **é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢**ï¼Œæ ‡å‡†æ¨¡å¼100kbpsï¼Œå¿«é€Ÿæ¨¡å¼400kbpsã€‚ |
| **å†…ç½®å¯»å€æœºåˆ¶**ï¼Œå¯ä»¥åœ¨æ€»çº¿ä¸Šè½»æ¾æ·»åŠ æˆ–ç§»é™¤è®¾å¤‡ã€‚    | **åŠåŒå·¥é€šä¿¡**ï¼Œæ•°æ®ä¸èƒ½åŒæ—¶æ”¶å‘ã€‚                  |
| **æœ‰åº”ç­”ï¼ˆACKï¼‰æœºåˆ¶**ï¼Œé€šä¿¡æ›´å¯é ï¼ŒMaster çŸ¥é“ä»Žè®¾å¤‡çš„çŠ¶æ€ã€‚ | **åè®®æ›´å¤æ‚**ï¼Œæœ‰èµ·å§‹/åœæ­¢/åº”ç­”ç­‰çŠ¶æ€ï¼Œè½¯ä»¶å¼€é”€æ›´å¤§ã€‚   |
| **æ”¯æŒå¤šä¸»æŽ§**ï¼Œå…è®¸å¤šä¸ª Master æŽ§åˆ¶æ€»çº¿ï¼ˆæœ‰ä»²è£æœºåˆ¶ï¼‰ã€‚ | **ç¡¬ä»¶ä¸Šéœ€è¦ä¸Šæ‹‰ç”µé˜»**ï¼Œæ€»çº¿ç”µå®¹ä¼šé™åˆ¶è®¾å¤‡æ•°é‡å’Œé€šä¿¡è·ç¦»ã€‚ |

---

### **æ€»ç»“ä¸Žå¯¹æ¯”**

| ç‰¹æ€§             | SPI (ç§å¯†ç”µè¯çº¿)                        | I2C (ç”µè¯ä¼šè®®)                                  |
| ---------------- | --------------------------------------- | ----------------------------------------------- |
| **å¼•è„šæ•°é‡**     | **å¤š (4æ ¹èµ·æ­¥)**ï¼Œæ¯ä¸ªä»Žè®¾å¤‡é¢å¤–å¢žåŠ 1æ ¹CSçº¿ | **å°‘ (ä»…2æ ¹)**ï¼Œä¸Žè®¾å¤‡æ•°é‡æ— å…³                |
| **é€Ÿåº¦**         | **å¿«** (>>1 Mbps)                         | **æ…¢** (<1 Mbps)                                |
| **é€šä¿¡æ¨¡å¼**     | **å…¨åŒå·¥** (å¯åŒæ—¶æ”¶å‘)                   | **åŠåŒå·¥** (åŒä¸€æ—¶é—´åªèƒ½å•å‘ä¼ è¾“)               |
| **è®¾å¤‡è§’è‰²**     | ä¸¥æ ¼çš„**ä¸»ä»Ž**æ¨¡å¼                      | **å¤šä¸»æŽ§ï¼Œå¤šä»Žè®¾å¤‡**                            |
| **ä»Žè®¾å¤‡é€‰æ‹©**   | é€šè¿‡ç‹¬ç«‹çš„ **CS ç‰‡é€‰çº¿**                | é€šè¿‡æ€»çº¿å¹¿æ’­ **è®¾å¤‡åœ°å€**                       |
| **å¯é æ€§**       | **æ— **å†…ç½®åº”ç­”æœºåˆ¶                      | **æœ‰** ACK/NACK åº”ç­”æœºåˆ¶                        |
| **åº”ç”¨åœºæ™¯**     | é«˜é€Ÿæ•°æ®æµï¼Œå¦‚ **SDå¡ã€æ˜¾ç¤ºå±ã€é«˜é€ŸADC/DAC** | è¿žæŽ¥å¤§é‡ä½Žé€Ÿå¤–è®¾ï¼Œå¦‚ **å„ç§ä¼ æ„Ÿå™¨ã€EEPROMã€å®žæ—¶æ—¶é’Ÿ** |

**ä¸€å¥è¯æ€»ç»“ï¼š**

*   å½“ä½ éœ€è¦**é«˜é€ŸçŽ‡**ã€**ç‚¹å¯¹ç‚¹**ï¼ˆæˆ–ç‚¹å¯¹å°‘æ•°å‡ ä¸ªç‚¹ï¼‰çš„æ•°æ®ä¼ è¾“ï¼Œå¹¶ä¸”ä¸ä»‹æ„å¤šç”¨å‡ ä¸ªå¼•è„šæ—¶ï¼Œé€‰æ‹© **SPI**ã€‚
*   å½“ä½ éœ€è¦è¿žæŽ¥**å¾ˆå¤šè®¾å¤‡**ã€**å¼•è„šèµ„æºç´§å¼ **ï¼Œå¹¶ä¸”å¯¹é€Ÿåº¦è¦æ±‚ä¸é«˜æ—¶ï¼Œé€‰æ‹© **I2C**ã€‚